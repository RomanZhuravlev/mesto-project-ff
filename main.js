(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-7",headers:{authorization:"dfd432e7-8dee-4b29-8ba8-64f22dc5eee3","Content-Type":"application/json"}};function t(e){return e.ok?e.json():e.json().then((function(t){return t.httpResponseCode=e.status,Promise.reject(t)}))}function n(n){return fetch("".concat(e.baseUrl,"/cards/").concat(n),{method:"DELETE",headers:e.headers}).then(t)}var r=document.querySelector("#card-template").content;function o(n,o,c,a){var i=r.querySelector(".card").cloneNode(!0),u=i.querySelector(".card__delete-button"),l=i.querySelector(".card__image"),s=i.querySelector(".card__like-button"),d=i.querySelector(".card__like-counter");function p(e){d.textContent=e.likes.length,e.likes.some((function(e){return e._id===o}))?s.classList.add("card__like-button_is-active"):s.classList.remove("card__like-button_is-active")}return i.querySelector(".card__title").textContent=n.name,l.src=n.link,l.alt=n.name,o===n.ownerId?u.addEventListener("click",(function(){c(n.cardId).then((function(){i.remove()})).catch((function(e){return console.log(e)}))})):u.remove(),p(n),s.addEventListener("click",(function(){var r,o;(r=n.cardId,o=s.classList.contains("card__like-button_is-active"),fetch("".concat(e.baseUrl,"/cards/likes/").concat(r),{method:o?"DELETE":"PUT",headers:e.headers}).then(t)).then((function(e){p(e)})).catch((function(e){return console.log(e)}))})),l.addEventListener("click",(function(){return a(n.link,n.name)})),i}function c(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",i)}function a(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",i)}function i(e){"Escape"===e.key&&a(document.querySelector(".popup_is-opened"))}var u=["inputSelector","submitButtonSelector"],l=["formSelector"];function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var d=function(e,t,n){var r=n.inputErrorClass,o=n.errorClass,c=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(r),c.classList.remove(o),c.textContent=""},p=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(n),t.disabled=!1):(t.classList.add(n),t.disabled=!0)},f=function(e,t){var n=t.inputSelector,r=t.submitButtonSelector,o=t.inactiveButtonClass,c=Array.from(e.querySelectorAll(n)),a=e.querySelector(r);p(c,a,o),c.forEach((function(n){d(e,n,t)}))};function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y,v=document.querySelector(".places__list"),_=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),b=document.querySelector(".profile__title"),S=document.querySelector(".profile__description"),k=document.querySelector(".profile__image"),C=document.querySelector(".popup_type_edit"),g=C.querySelector(".popup__input_type_name"),q=C.querySelector(".popup__input_type_description"),E=document.querySelector(".popup_type_new-card"),L=document.querySelector(".popup_type_edit-avatar"),x=document.querySelector(".popup_type_image"),w=x.querySelector(".popup__image"),O=x.querySelector(".popup__caption"),A=document.forms["edit-profile"],j=A.elements.name,I=A.elements.description,U=document.forms["new-place"],P=U.elements["place-name"],T=U.elements.link,B=document.forms["edit-avatar"],D=B.elements.link,M=document.querySelectorAll(".popup"),N={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function J(e,t){w.src=e,w.alt=t,O.textContent=t,c(x)}M.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_is-opened")&&a(e),t.target.classList.contains("popup__close")&&a(e)}))})),_.addEventListener("click",(function(){g.value=b.textContent,q.value=S.textContent,f(A,N),c(C)})),h.addEventListener("click",(function(){P.value="",T.value="",f(U,N),c(E)})),k.addEventListener("click",(function(){D.value="",f(B,N),c(L)})),A.addEventListener("submit",(function(n){var r,o;n.preventDefault(),n.submitter.textContent="Сохранить...",(r=j.value,o=I.value,fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify({name:r,about:o})}).then(t)).then((function(e){b.textContent=e.name,S.textContent=e.about,a(C)})).catch((function(e){return console.log(e)})).finally((function(){n.submitter.textContent="Сохранить"}))})),U.addEventListener("submit",(function(r){var c,i;r.preventDefault(),r.submitter.textContent="Сохранить...",(c=P.value,i=T.value,fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify({name:c,link:i})}).then(t)).then((function(e){var t={name:e.name,link:e.link,likes:e.likes,cardId:e._id,ownerId:e.owner._id};v.prepend(o(t,y,n,J)),a(E),U.reset()})).catch((function(e){return console.log(e)})).finally((function(){r.submitter.textContent="Сохранить"}))})),B.addEventListener("submit",(function(n){var r;n.preventDefault(),n.submitter.textContent="Сохранить...",(r=D.value,fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:r})}).then(t)).then((function(e){k.style.backgroundImage="url(".concat(e.avatar,")"),a(L)})).catch((function(e){return console.log(e)})).finally((function(){n.submitter.textContent="Сохранить"}))})),function(e){var t=e.formSelector,n=s(e,l);Array.from(document.querySelectorAll(t)).forEach((function(e){!function(e,t){var n=t.inputSelector,r=t.submitButtonSelector,o=s(t,u),c=Array.from(e.querySelectorAll(n)),a=e.querySelector(r);p(c,a),c.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?d(e,t,n):function(e,t,n,r){var o=r.inputErrorClass,c=r.errorClass,a=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o),a.textContent=n,a.classList.add(c)}(e,t,t.validationMessage,n)}(e,t,o),p(c,a,o.inactiveButtonClass)}))}))}(e,n)}))}(N),Promise.all([fetch("".concat(e.baseUrl,"/users/me"),{headers:e.headers}).then(t),fetch("".concat(e.baseUrl,"/cards"),{headers:e.headers}).then(t)]).then((function(e){var t,r,c=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,i=[],u=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return i}}(t,r)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=c[0],i=c[1];b.textContent=a.name,S.textContent=a.about,k.style.backgroundImage="url(".concat(a.avatar,")"),y=a._id,i.forEach((function(e){var t={name:e.name,link:e.link,likes:e.likes,cardId:e._id,ownerId:e.owner._id};v.append(o(t,y,n,J))}))})).catch((function(e){return console.log(e)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUQsRUFBQSxHQUFFRSxFQUFLRixFQUFBLEdBQ3JCekQsRUFBYXpELFlBQWNtSCxFQUFTMUcsS0FDcENpRCxFQUFtQjFELFlBQWNtSCxFQUFTeEIsTUFDMUNoQyxFQUFXc0MsTUFBTUMsZ0JBQWtCLE9BQUhySCxPQUFVc0ksRUFBU25CLE9BQU0sS0FDekQzQyxFQUFPOEQsRUFBUzlHLElBRWhCK0csRUFBTWhFLFNBQVEsU0FBQ3JELEdBQ2IsSUFBTVgsRUFBVyxDQUNmcUIsS0FBTVYsRUFBS1UsS0FDWEUsS0FBTVosRUFBS1ksS0FDWFYsTUFBT0YsRUFBS0UsTUFDWmMsT0FBUWhCLEVBQUtNLElBQ2JRLFFBQVNkLEVBQUs4RixNQUFNeEYsS0FFdEJpRCxFQUFnQitELE9BQU9sSSxFQUFXQyxFQUFVaUUsRUFBTTNFLEVBQVlzRyxHQUNoRSxHQUNGLElBQ0NoRSxPQUFNLFNBQUMzQyxHQUFLLE9BQUs0QyxRQUFRQyxJQUFJN0MsRUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9zY3JpcHRzL2FwaS5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL3NjcmlwdHMvY2FyZC5qcyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL3NjcmlwdHMvbW9kYWwuanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9zY3JpcHRzL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNvbmZpZyA9IHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vbm9tb3JlcGFydGllcy5jby92MS93ZmYtY29ob3J0LTdcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImRmZDQzMmU3LThkZWUtNGIyOS04YmE4LTY0ZjIyZGM1ZWVlM1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufTtcclxuXHJcbi8vINC/0YDQvtCy0LXRgNC60LAg0L7RgtCy0LXRgtCwXHJcbmZ1bmN0aW9uIGNoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgaWYgKHJlcy5vaykge1xyXG4gICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcmVzXHJcbiAgICAuanNvbigpIC8vINCy0YvRgtCw0YnQuNC8INC+0YLQstC10YIg0YHQtdGA0LLQtdGA0LBcclxuICAgIC50aGVuKChlcnJvcikgPT4ge1xyXG4gICAgICBlcnJvci5odHRwUmVzcG9uc2VDb2RlID0gcmVzLnN0YXR1cztcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlckluZm8oKSB7XHJcbiAgcmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pLnRoZW4oY2hlY2tSZXNwb25zZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDYXJkcygpIHtcclxuICByZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgfSkudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVkaXRQcm9maWxlKG5hbWUsIGpvYikge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICBhYm91dDogam9iLFxyXG4gICAgfSksXHJcbiAgfSkudGhlbihjaGVja1Jlc3BvbnNlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkZENhcmQobmFtZSwgbGluaykge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgaGVhZGVyczogY29uZmlnLmhlYWRlcnMsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgIGxpbms6IGxpbmssXHJcbiAgICB9KSxcclxuICB9KS50aGVuKGNoZWNrUmVzcG9uc2UpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlQ2FyZChpZCkge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICB9KS50aGVuKGNoZWNrUmVzcG9uc2UpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlTGlrZShpZCwgaXNMaWtlZCkge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgIGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG4gIH0pLnRoZW4oY2hlY2tSZXNwb25zZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBlZGl0QXZhdGFyKGF2YXRhcikge1xyXG4gIHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICBoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgYXZhdGFyOiBhdmF0YXIsXHJcbiAgICB9KSxcclxuICB9KS50aGVuKGNoZWNrUmVzcG9uc2UpO1xyXG59XHJcbiIsImltcG9ydCB7IHRvZ2dsZUxpa2UgfSBmcm9tIFwiLi9hcGlcIjtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50O1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSwgbXlVc2VySWQsIG9uUmVtb3ZlLCBvblpvb20pIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICBjb25zdCBjYXJkTGlrZUNvdW50ZXIgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuXHJcbiAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKS50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgY2FyZEltYWdlLnNyYyA9IGNhcmREYXRhLmxpbms7XHJcbiAgY2FyZEltYWdlLmFsdCA9IGNhcmREYXRhLm5hbWU7XHJcblxyXG4gIC8vINCy0LXRiNCw0LXQvCDQuNC60L7QvdC60Lgg0LzRg9GB0L7RgNC60Lgg0YLQvtC70YzQutC+INC90LAg0YHQvtC30LTQsNC90L3Ri9C1INC90LDQvNC4INC60LDRgNGC0L7Rh9C60LhcclxuICBpZiAobXlVc2VySWQgPT09IGNhcmREYXRhLm93bmVySWQpIHtcclxuICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAvLyDRg9C00LDQu9C10L3QuNC1INGBINGB0LXRgNCy0LXRgNCwXHJcbiAgICAgIG9uUmVtb3ZlKGNhcmREYXRhLmNhcmRJZClcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAvLyDRg9C00LDQu9C10L3QuNC1INC40LcgRE9NXHJcbiAgICAgICAgICByZW1vdmVDYXJkKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGVycm9yKSk7XHJcbiAgICB9KTtcclxuICB9IGVsc2Uge1xyXG4gICAgZGVsZXRlQnV0dG9uLnJlbW92ZSgpOyAvLyDQtdGB0LvQuCDQutCw0YDRgtCwINC90LUg0L3QsNGI0LAgLSDRg9C00LDQu9GP0LXQvCDQuNC60L7QvdC60YNcclxuICB9XHJcblxyXG4gIC8vINC+0LHRgNCw0LHQvtGC0LrQsCDQu9Cw0LnQutC+0LJcclxuICBmdW5jdGlvbiByZW5kZXJMaWtlcyhjYXJkKSB7XHJcbiAgICBjYXJkTGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSBjYXJkLmxpa2VzLmxlbmd0aDsgLy8g0LLRi9Cy0L7QtNC40Lwg0YfQuNGB0LvQviDQu9Cw0LnQutC+0LIg0LIg0YHRh9C10YLRh9C40LpcclxuICAgIGlmIChjYXJkLmxpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSBteVVzZXJJZCkpIHtcclxuICAgICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZVwiKTsgLy8g0LXRgdC70Lgg0LzRiyDQu9Cw0LnQutCw0LvQuCDQutCw0YDRgtC+0YfQutGDIC0g0LvQsNC50Log0LfQsNC60YDQsNGI0LXQvVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZVwiKTsgLy8g0LXRgdC70Lgg0L3QtSDQu9Cw0LnQutCw0LvQuCAtINC70LDQudC6INC90LXQt9Cw0LrRgNCw0YjQtdC9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXJMaWtlcyhjYXJkRGF0YSk7IC8vINC/0LXRgNCy0LjRh9C90LDRjyDQv9GA0L7QstC10YDQutCwXHJcblxyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAvLyDQsiDQvtCx0YDQsNCx0L7RgtGH0LjQuiDQv9C10YDQtdC00LDQtdC8INGD0L3QuNCy0LXRgNGB0LDQu9GM0L3Rg9GOINGELdC40Y4g0LrQvtGC0L7RgNCw0Y8g0LzQvtC20LXRgiDQu9C40LHQviDRg9C00LDQu9GP0YLRjCwg0LvQuNCx0L4g0LLQvdC+0YHQuNGC0YxcclxuICAgIHRvZ2dsZUxpa2UoXHJcbiAgICAgIGNhcmREYXRhLmNhcmRJZCxcclxuICAgICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlXCIpXHJcbiAgICApXHJcbiAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgLy8g0LzQtdC90Y/QtdC8INGB0L7RgdGC0L7Rj9C90LjRjyDQv9C+0YHQu9C1INC+0YLQstC10YLQsCDRgdC10YDQstC10YDQsFxyXG4gICAgICAgIHJlbmRlckxpa2VzKGRhdGEpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhlcnJvcikpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICBvblpvb20oY2FyZERhdGEubGluaywgY2FyZERhdGEubmFtZSlcclxuICApO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUNhcmQoY2FyZCkge1xyXG4gIGNhcmQucmVtb3ZlKCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7IGNyZWF0ZUNhcmQsIHJlbW92ZUNhcmQgfTtcclxuIiwiZnVuY3Rpb24gc2hvd1BvcHVwKHBvcHVwVG9PcGVuKSB7XHJcbiAgcG9wdXBUb09wZW4uY2xhc3NMaXN0LmFkZChcInBvcHVwX2lzLW9wZW5lZFwiKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwKSB7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX2lzLW9wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGUpO1xyXG59XHJcblxyXG4vLyDQt9Cw0LrRgNGL0YLQuNC1INC/0L7Qv9Cw0L/QsCBFc2Mn0L7QvFxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZlbnQpIHtcclxuICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBvcGVuZWRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfaXMtb3BlbmVkXCIpO1xyXG4gICAgY2xvc2VQb3B1cChvcGVuZWRQb3B1cCk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBzaG93UG9wdXAsIGNsb3NlUG9wdXAsIGhhbmRsZUVzY2FwZSB9O1xyXG4iLCIvLyDQv9C+0LrQsNC3INC+0YjQuNCx0L7QulxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChcclxuICBmb3JtRWxlbWVudCxcclxuICBpbnB1dEVsZW1lbnQsXHJcbiAgZXJyb3JNZXNzYWdlLFxyXG4gIHZhbGlkYXRpb25Db25maWdcclxuKSA9PiB7XHJcbiAgY29uc3QgeyBpbnB1dEVycm9yQ2xhc3MsIGVycm9yQ2xhc3MgfSA9IHZhbGlkYXRpb25Db25maWc7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGlucHV0RXJyb3JDbGFzcyk7XHJcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuLy8g0YHQutGA0YvRgtC40LUg0L7RiNC40LHQvtC6XHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpID0+IHtcclxuICBjb25zdCB7IGlucHV0RXJyb3JDbGFzcywgZXJyb3JDbGFzcyB9ID0gdmFsaWRhdGlvbkNvbmZpZztcclxuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG59O1xyXG5cclxuLy8g0L/RgNC+0LLQtdGA0LrQsCDQuNC90L/Rg9GC0LAg0L3QsCDQstCw0LvQuNC00L3QvtGB0YLRjFxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIC8vINC/0YDQvtCy0LXRgNC60LAg0YDQtdCz0YPQu9GP0YDQvdGL0Lwg0LLRi9GA0LDQttC10L3QuNC10LxcclxuICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnBhdHRlcm5NaXNtYXRjaCkge1xyXG4gICAgaW5wdXRFbGVtZW50LnNldEN1c3RvbVZhbGlkaXR5KGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yTWVzc2FnZSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGlucHV0RWxlbWVudC5zZXRDdXN0b21WYWxpZGl0eShcIlwiKTtcclxuICB9XHJcbiAgLy8g0L7QsdGJ0LDRjyDQv9GA0L7QstC10YDQutCwXHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKFxyXG4gICAgICBmb3JtRWxlbWVudCxcclxuICAgICAgaW5wdXRFbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXHJcbiAgICAgIHZhbGlkYXRpb25Db25maWdcclxuICAgICk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25Db25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbi8vINC/0YDQvtCy0LXRgNC60LAg0L3QsCDQvdC10LLQsNC70LjQtNC90YvQtSDQuNC90L/Rg9GC0YtcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuXHJcbi8vINGB0LzQtdC90LAg0YHQvtGB0YLQvtGP0L3QuNGPINC60L3QvtC/0LrQuCBzdWJtaXRcclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBpbmFjdGl2ZUJ1dHRvbkNsYXNzKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9IGVsc2Uge1xyXG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxufTtcclxuXHJcbi8vINC+0LHRhdC+0LQg0Lgg0L7QsdGA0LDQsdC+0YLQutCwINCy0YHQtdGFINC40L3Qv9GD0YLQvtCyXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBmb3JtQ29uZmlnKSA9PiB7XHJcbiAgY29uc3QgeyBpbnB1dFNlbGVjdG9yLCBzdWJtaXRCdXR0b25TZWxlY3RvciwgLi4udmFsaWRhdGlvbkNvbmZpZyB9ID1cclxuICAgIGZvcm1Db25maWc7IC8vINC/0YDQvtC00L7Qu9C20LDQtdC8INC00LXRgdGC0YDRg9C60YLRg9GA0LjRgNC+0LLQsNGC0Ywg0L7QsdGK0LXQutGCXHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihzdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7IC8vINGB0YDQsNC30YMg0L/RgNC+0LLQtdGA0Y/QtdC8INC40L3Qv9GD0YLRiyDQuCDQtdGB0LvQuCDQvdGD0LbQvdC+INC80LXQvdGP0LXQvCDRgdC+0YHRgtC+0Y/QvdC40LUg0LrQvdC+0L/QutC4XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7IC8vINC/0L7RgdC70LUg0LrQsNC20LTQvtCz0L4g0LLQt9Cw0LjQvC3RjyDRgSDQuNC90L/Rg9GC0LDQvNC4INC/0YDQvtCy0LXRgNGP0LXQvCDQvdCwINCy0LDQu9C40LTQvdC+0YHRgtGMXHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKFxyXG4gICAgICAgIGlucHV0TGlzdCxcclxuICAgICAgICBidXR0b25FbGVtZW50LFxyXG4gICAgICAgIHZhbGlkYXRpb25Db25maWcuaW5hY3RpdmVCdXR0b25DbGFzc1xyXG4gICAgICApOyAvLyDQv9C+0YHRgtC+0Y/QvdC90L4g0L/RgNC+0LLQtdGA0Y/QtdC8INC40L3Qv9GD0YLRiyDQuCDQvNC10L3Rj9C10Lwg0YHRgtCw0YLRg9GBINC60L3QvtC/0LrQuCDQtdGB0LvQuCDQvdGD0LbQvdC+XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbi8vINC+0LHRhdC+0LQg0Lgg0L7QsdGA0LDQsdC+0YLQutCwINCy0YHQtdGFINGE0L7RgNC8XHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIC8vINC+0LHRgNCw0LHQvtGC0LrQsCDQutC+0L3RhNC40LPQsCDQtNC10LvQsNC10YIg0YQt0LjRjiDRg9C90LjQstC10YDRgdCw0LvRjNC90L7QuVxyXG4gIGNvbnN0IHsgZm9ybVNlbGVjdG9yLCAuLi5mb3JtQ29uZmlnIH0gPSB2YWxpZGF0aW9uQ29uZmlnOyAvLyDRgSDQv9C+0LzQvtGJ0YzRjiDQtNC10YHRgtGA0YPQutGC0YPRgNC40LfQsNGG0LjQuCDRgNCw0LHQvtGC0LDQtdC8INGBINC+0LHRitC10LrRgtC+0LxcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChmb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGZvcm1Db25maWcpOyAvLyDQv9C10YDQtdC00LDQtdC8INC40LfQvNC10L3QtdC90L3Ri9C5INC+0LHRitC10LrRgiDQsiDRgdC70LXQtNGD0Y7RidGD0Y4g0YQt0LjRjlxyXG4gIH0pO1xyXG59O1xyXG5cclxuLy8g0L7Rh9C40YHRgtC60LAg0L7RiNC40LHQvtC6XHJcbmNvbnN0IGNsZWFyVmFsaWRhdGlvbiA9IChwcm9maWxlRm9ybSwgdmFsaWRhdGlvbkNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IHsgaW5wdXRTZWxlY3Rvciwgc3VibWl0QnV0dG9uU2VsZWN0b3IsIGluYWN0aXZlQnV0dG9uQ2xhc3MgfSA9XHJcbiAgICB2YWxpZGF0aW9uQ29uZmlnOyAvLyDQtNC10YHRgtGA0YPQutGC0YPRgNC40YDRg9C10Lwg0L7QsdGK0LXQutGCXHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShwcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yQWxsKGlucHV0U2VsZWN0b3IpKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gcHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihzdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBpbmFjdGl2ZUJ1dHRvbkNsYXNzKTsgLy8g0LzQtdC90Y/QtdC8INGB0L7RgdGC0L7Rj9C90LjQtSDQutC90L7Qv9C60LhcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgLy8g0L7QsdGF0L7QtNC40Lwg0LLRgdC1INC40L3Qv9GD0YLRiyDQuCDRgdC60YDRi9Cy0LDQtdC8INC+0YjQuNCx0LrQuFxyXG4gICAgaGlkZUlucHV0RXJyb3IocHJvZmlsZUZvcm0sIGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgeyBlbmFibGVWYWxpZGF0aW9uLCBjbGVhclZhbGlkYXRpb24gfTtcclxuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IGNyZWF0ZUNhcmQgfSBmcm9tIFwiLi9jYXJkXCI7XHJcbmltcG9ydCB7IHNob3dQb3B1cCwgY2xvc2VQb3B1cCB9IGZyb20gXCIuL21vZGFsXCI7XHJcbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIGNsZWFyVmFsaWRhdGlvbiB9IGZyb20gXCIuL3ZhbGlkYXRpb25cIjtcclxuaW1wb3J0IHtcclxuICBnZXRVc2VySW5mbyxcclxuICBnZXRDYXJkcyxcclxuICBlZGl0UHJvZmlsZSxcclxuICBhZGRDYXJkLFxyXG4gIGRlbGV0ZUNhcmQsXHJcbiAgZWRpdEF2YXRhcixcclxufSBmcm9tIFwiLi9hcGlcIjtcclxuXHJcbi8vINC+0YLQtNC10LvRjNC90YvQtSDRhNCw0LnQu9GLINC00LvRjyDQutC+0L3RgdGC0LDQvdGCINC4INGD0YLQuNC70LjRgiDRjyDRgdC00LXQu9Cw0Y4g0L/QvtC30LbQtSwg0YLQuiDRjdGC0L4g0L3QtSDQutGA0LjRgtC40YfQtdGB0LrQuCDQstCw0LbQvdC+INC90LAg0LTQsNC90L3QvtC8INGN0YLQsNC/0LVcclxuXHJcbmNvbnN0IHBsYWNlc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19saXN0XCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBoZWFkZXJMb2dvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9lZGl0XCIpO1xyXG5jb25zdCBwb3B1cElucHV0TmFtZSA9IHByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIik7XHJcbmNvbnN0IHBvcHVwSW5wdXREZXNjcmlwdGlvbiA9IHByb2ZpbGVQb3B1cC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuXHJcbmNvbnN0IGNhcmRBZGRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9uZXctY2FyZFwiKTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfdHlwZV9lZGl0LWF2YXRhclwiKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfaW1hZ2VcIik7XHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xyXG5jb25zdCBwb3B1cENhcHRpb24gPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2NhcHRpb25cIik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtcHJvZmlsZVwiXTtcclxuY29uc3QgZWRpdEZvcm1OYW1lSW5wdXQgPSBlZGl0Rm9ybUVsZW1lbnQuZWxlbWVudHNbXCJuYW1lXCJdO1xyXG5jb25zdCBlZGl0Rm9ybUpvYklucHV0ID0gZWRpdEZvcm1FbGVtZW50LmVsZW1lbnRzW1wiZGVzY3JpcHRpb25cIl07XHJcblxyXG5jb25zdCBhZGRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wibmV3LXBsYWNlXCJdO1xyXG5jb25zdCBhZGRGb3JtTmFtZUlucHV0ID0gYWRkRm9ybUVsZW1lbnQuZWxlbWVudHNbXCJwbGFjZS1uYW1lXCJdO1xyXG5jb25zdCBhZGRGb3JtTGlua0lucHV0ID0gYWRkRm9ybUVsZW1lbnQuZWxlbWVudHNbXCJsaW5rXCJdO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhckZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LWF2YXRhclwiXTtcclxuY29uc3QgZWRpdEF2YXRhckZvcm1VcmxJbnB1dCA9IGVkaXRBdmF0YXJGb3JtRWxlbWVudC5lbGVtZW50c1tcImxpbmtcIl07XHJcblxyXG5jb25zdCBwb3B1cHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwXCIpO1xyXG5jb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIucG9wdXBfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXBfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxubGV0IG15SWQ7IC8vINGB0Y7QtNCwINCy0YvRgtCw0YnQuNC8INC30L3QsNGH0LXQvdC40LUg0LjQtyBnZXRVc2VySW5mbygpINC00LvRjyDQtNCw0LvRjNC90LXQudGI0LXQs9C+INC/0LXRgNC10LjRgdC/0L7Qu9GM0LfQvtCy0LDQvdC40Y9cclxuXHJcbi8vINC+0LHRitC10LTQuNC90LXQvdC40LUg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINC+0LLQtdGA0LvQtdGPINC4INC60YDQtdGB0YLQuNC60L7QslxyXG5wb3B1cHMuZm9yRWFjaCgocG9wdXApID0+IHtcclxuICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX2lzLW9wZW5lZFwiKSkge1xyXG4gICAgICBjbG9zZVBvcHVwKHBvcHVwKTsgLy8g0L/RgNC+0LLQtdGA0LrQsCwg0L3QsNC20LDQu9C4INC90LAg0L7QstC10YDQu9C10Lkg0LjQu9C4INC90LXRgiwg0Lgg0LfQsNC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LBcclxuICAgIH1cclxuICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwX19jbG9zZVwiKSkge1xyXG4gICAgICBjbG9zZVBvcHVwKHBvcHVwKTsgLy8g0L/RgNC+0LLQtdGA0LrQsCwg0L3QsNC20LDQu9C4INC90LAg0LrRgNC10YHRgtC40Log0LjQu9C4INC90LXRgiwg0Lgg0LfQsNC60YDRi9GC0LjQtSDQv9C+0L/QsNC/0LBcclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiB6b29tQ2FyZChjYXJkSW1hZ2UsIGNhcmREZXNjcmlwdGlvbikge1xyXG4gIHBvcHVwSW1hZ2Uuc3JjID0gY2FyZEltYWdlO1xyXG4gIHBvcHVwSW1hZ2UuYWx0ID0gY2FyZERlc2NyaXB0aW9uO1xyXG4gIHBvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREZXNjcmlwdGlvbjtcclxuXHJcbiAgc2hvd1BvcHVwKGltYWdlUG9wdXApO1xyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHBvcHVwSW5wdXROYW1lLnZhbHVlID0gcHJvZmlsZVRpdGxlLnRleHRDb250ZW50O1xyXG4gIHBvcHVwSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICBjbGVhclZhbGlkYXRpb24oZWRpdEZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBzaG93UG9wdXAocHJvZmlsZVBvcHVwKTtcclxufSk7XHJcblxyXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkRm9ybU5hbWVJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgYWRkRm9ybUxpbmtJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKGFkZEZvcm1FbGVtZW50LCB2YWxpZGF0aW9uQ29uZmlnKTtcclxuICBzaG93UG9wdXAoY2FyZEFkZFBvcHVwKTtcclxufSk7XHJcblxyXG5oZWFkZXJMb2dvLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdEF2YXRhckZvcm1VcmxJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgY2xlYXJWYWxpZGF0aW9uKGVkaXRBdmF0YXJGb3JtRWxlbWVudCwgdmFsaWRhdGlvbkNvbmZpZyk7XHJcbiAgc2hvd1BvcHVwKGVkaXRBdmF0YXJQb3B1cCk7XHJcbn0pO1xyXG5cclxuLy8g0YHQu9GD0YjQsNGC0LXQu9GMINC/0YDQuCDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNC4XHJcbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCLQodC+0YXRgNCw0L3QuNGC0YwuLi5cIjtcclxuXHJcbiAgZWRpdFByb2ZpbGUoZWRpdEZvcm1OYW1lSW5wdXQudmFsdWUsIGVkaXRGb3JtSm9iSW5wdXQudmFsdWUpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IHJlcy5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSByZXMuYWJvdXQ7XHJcbiAgICAgIGNsb3NlUG9wdXAocHJvZmlsZVBvcHVwKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmxvZyhlcnJvcikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGV2ZW50LnN1Ym1pdHRlci50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LjRgtGMXCI7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vLyDRgdC70YPRiNCw0YLQtdC70Ywg0L/RgNC4INC00L7QsdCw0LLQu9C10L3QuNC4INC90L7QstC+0Lkg0LrQsNGA0YLQvtGH0LrQuFxyXG5hZGRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCLQodC+0YXRgNCw0L3QuNGC0YwuLi5cIjtcclxuXHJcbiAgYWRkQ2FyZChhZGRGb3JtTmFtZUlucHV0LnZhbHVlLCBhZGRGb3JtTGlua0lucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRGF0YSA9IHtcclxuICAgICAgICBuYW1lOiByZXMubmFtZSxcclxuICAgICAgICBsaW5rOiByZXMubGluayxcclxuICAgICAgICBsaWtlczogcmVzLmxpa2VzLFxyXG4gICAgICAgIGNhcmRJZDogcmVzLl9pZCxcclxuICAgICAgICBvd25lcklkOiByZXMub3duZXIuX2lkLFxyXG4gICAgICB9O1xyXG4gICAgICBwbGFjZXNDb250YWluZXIucHJlcGVuZChjcmVhdGVDYXJkKGNhcmREYXRhLCBteUlkLCBkZWxldGVDYXJkLCB6b29tQ2FyZCkpO1xyXG4gICAgICBjbG9zZVBvcHVwKGNhcmRBZGRQb3B1cCk7XHJcbiAgICAgIGFkZEZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChyZXMpID0+IGNvbnNvbGUubG9nKHJlcykpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGV2ZW50LnN1Ym1pdHRlci50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LjRgtGMXCI7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5lZGl0QXZhdGFyRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGV2ZW50LnN1Ym1pdHRlci50ZXh0Q29udGVudCA9IFwi0KHQvtGF0YDQsNC90LjRgtGMLi4uXCI7XHJcblxyXG4gIGVkaXRBdmF0YXIoZWRpdEF2YXRhckZvcm1VcmxJbnB1dC52YWx1ZSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgaGVhZGVyTG9nby5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7cmVzLmF2YXRhcn0pYDtcclxuICAgICAgY2xvc2VQb3B1cChlZGl0QXZhdGFyUG9wdXApO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGVycm9yKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZXZlbnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCLQodC+0YXRgNCw0L3QuNGC0YxcIjtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvbkNvbmZpZyk7IC8vINCy0LDQu9C40LDQtNCw0YbQuNGPXHJcblxyXG5Qcm9taXNlLmFsbChbZ2V0VXNlckluZm8oKSwgZ2V0Q2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VySW5mbywgY2FyZHNdKSA9PiB7XHJcbiAgICBwcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XHJcbiAgICBoZWFkZXJMb2dvLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt1c2VySW5mby5hdmF0YXJ9KWA7XHJcbiAgICBteUlkID0gdXNlckluZm8uX2lkO1xyXG5cclxuICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcclxuICAgICAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICAgICAgbmFtZTogY2FyZC5uYW1lLFxyXG4gICAgICAgIGxpbms6IGNhcmQubGluayxcclxuICAgICAgICBsaWtlczogY2FyZC5saWtlcyxcclxuICAgICAgICBjYXJkSWQ6IGNhcmQuX2lkLFxyXG4gICAgICAgIG93bmVySWQ6IGNhcmQub3duZXIuX2lkLFxyXG4gICAgICB9O1xyXG4gICAgICBwbGFjZXNDb250YWluZXIuYXBwZW5kKGNyZWF0ZUNhcmQoY2FyZERhdGEsIG15SWQsIGRlbGV0ZUNhcmQsIHpvb21DYXJkKSk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUubG9nKGVycm9yKSk7XHJcbiJdLCJuYW1lcyI6WyJjb25maWciLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJjaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwidGhlbiIsImVycm9yIiwiaHR0cFJlc3BvbnNlQ29kZSIsInN0YXR1cyIsIlByb21pc2UiLCJyZWplY3QiLCJkZWxldGVDYXJkIiwiaWQiLCJmZXRjaCIsImNvbmNhdCIsIm1ldGhvZCIsImNhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJteVVzZXJJZCIsIm9uUmVtb3ZlIiwib25ab29tIiwiY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJkZWxldGVCdXR0b24iLCJjYXJkSW1hZ2UiLCJjYXJkTGlrZUJ1dHRvbiIsImNhcmRMaWtlQ291bnRlciIsInJlbmRlckxpa2VzIiwiY2FyZCIsInRleHRDb250ZW50IiwibGlrZXMiLCJsZW5ndGgiLCJzb21lIiwibGlrZSIsIl9pZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIm5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0Iiwib3duZXJJZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjYXJkSWQiLCJjYXRjaCIsImNvbnNvbGUiLCJsb2ciLCJpc0xpa2VkIiwiY29udGFpbnMiLCJkYXRhIiwic2hvd1BvcHVwIiwicG9wdXBUb09wZW4iLCJoYW5kbGVFc2NhcGUiLCJjbG9zZVBvcHVwIiwicG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwidmFsaWRhdGlvbkNvbmZpZyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJlcnJvckVsZW1lbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiY2xlYXJWYWxpZGF0aW9uIiwicHJvZmlsZUZvcm0iLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsIm15SWQiLCJwbGFjZXNDb250YWluZXIiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJoZWFkZXJMb2dvIiwicHJvZmlsZVBvcHVwIiwicG9wdXBJbnB1dE5hbWUiLCJwb3B1cElucHV0RGVzY3JpcHRpb24iLCJjYXJkQWRkUG9wdXAiLCJlZGl0QXZhdGFyUG9wdXAiLCJpbWFnZVBvcHVwIiwicG9wdXBJbWFnZSIsInBvcHVwQ2FwdGlvbiIsImVkaXRGb3JtRWxlbWVudCIsImZvcm1zIiwiZWRpdEZvcm1OYW1lSW5wdXQiLCJlbGVtZW50cyIsImVkaXRGb3JtSm9iSW5wdXQiLCJhZGRGb3JtRWxlbWVudCIsImFkZEZvcm1OYW1lSW5wdXQiLCJhZGRGb3JtTGlua0lucHV0IiwiZWRpdEF2YXRhckZvcm1FbGVtZW50IiwiZWRpdEF2YXRhckZvcm1VcmxJbnB1dCIsInBvcHVwcyIsImZvcm1TZWxlY3RvciIsInpvb21DYXJkIiwiY2FyZERlc2NyaXB0aW9uIiwiZXZ0IiwidGFyZ2V0IiwidmFsdWUiLCJqb2IiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdHRlciIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJmaW5hbGx5Iiwib3duZXIiLCJwcmVwZW5kIiwicmVzZXQiLCJhdmF0YXIiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImZvcm1Db25maWciLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMiLCJfZXhjbHVkZWQyIiwiX2V4Y2x1ZGVkIiwicGF0dGVybk1pc21hdGNoIiwic2V0Q3VzdG9tVmFsaWRpdHkiLCJkYXRhc2V0IiwiZXJyb3JNZXNzYWdlIiwic2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZW5hYmxlVmFsaWRhdGlvbiIsImFsbCIsIl9yZWYiLCJfcmVmMiIsInVzZXJJbmZvIiwiY2FyZHMiLCJhcHBlbmQiXSwic291cmNlUm9vdCI6IiJ9